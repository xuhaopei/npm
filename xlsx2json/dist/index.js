(()=>{"use strict";var e={519:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{a(n.next(e))}catch(e){i(e)}}function l(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,l)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=r(290),i=r(17),u=r(336),l=r(142),a=r(955);t.default=()=>n(void 0,void 0,void 0,(function*(){let e=yield o.prompt([{type:"input",message:"请填写xlsx文件绝对路径",name:"url",validate:function(e){return 0!=e.trim().length||(l.default.error("\n不允许为空"),!1)},default:""},{type:"input",message:"请填写旧json文件绝对路径，若取默认值，则生成对应的json文件",name:"jsonUrl",validate:function(e){return 0!=e.trim().length||(l.default.error("\n不允许为空"),!1)},default:"not use"},{type:"input",message:"请填写读取的哪一页，从0开始计算：",name:"index",validate:function(e){return!1!==/\d/g.test(e)||(l.default.error(`\n请输入数字，当前输入为：${e}`),!1)},default:"0"},{type:"input",message:"请填写读取的哪一列为key值，从0开始计算:",name:"key",validate:function(e){return!1!==/\d/g.test(e)||(l.default.error(`\n请输入数字，当前输入为：${e}`),!1)},default:"0"},{type:"input",message:"请填写读取的哪一列为value值，从0开始计算,以逗号分隔:",name:"values",validate:function(e){return!1!==/[\d,]/g.test(e)||(l.default.error(`\n请输入数字，当前输入为：${e}`),!1)},default:"0"}]),{url:t,jsonUrl:r,index:n,key:c,values:s}=e,d=[],f={};try{d=u.default.parse(t.trim().replace(/[\"\']/g,""))}catch(e){l.default.error("\n文件读取失败，当前文件路径为："+t),console.log(e)}try{"not use"!==r&&(f=yield(0,a.readJSON)(r.trim().replace(/[\"\']/g,"")))}catch(e){l.default.error("\n文件读取失败，当前文件路径为："+r),console.log(e)}let p=d[n].data,g=s.split(",");if("not use"===r)for(let e=0;e<g.length;e++){let t={},r=i.join(__dirname,`./${g[e]}.json`);l.default.error(`url:${r}`);for(let r=0;r<p.length;r++){let n=String(p[r][c]).trim().replace(/[\n]/g,",").replace(/["]/g,"'"),o=String(p[r][Number(g[e])]).trim().replace(/[\n]/g,",").replace(/["]/g,"'");"undefined"===n||"undefined"===o||f[n]||(t[n]=o)}(0,a.writeJSON)(r,t)}else for(let e=0;e<g.length;e++){l.default.error(`========values:${g[e]}=======`),l.default.error("{");for(let t=0;t<p.length;t++){let r=String(p[t][c]).trim().replace(/[\n]/g,",").replace(/["]/g,"'"),n=String(p[t][Number(g[e])]).trim().replace(/[\n]/g,",").replace(/["]/g,"'");"undefined"===r||"undefined"===n||f[r]||(t%2==0?l.default.primary(`"${r}":"${n}",`):l.default.success(`"${r}":"${n}",`))}l.default.error("}\n\n")}}))},955:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{a(n.next(e))}catch(e){i(e)}}function l(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,l)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteFileOrDir=t.writeJSON=t.readJSON=void 0;const o=r(470);t.readJSON=function(e){return n(this,void 0,void 0,(function*(){try{return yield o.readJson(e,{throws:!1})}catch(e){throw e}}))},t.writeJSON=function(e,t){return n(this,void 0,void 0,(function*(){try{yield o.outputFile(e,JSON.stringify(t,null,"\t"))}catch(e){console.error(e)}}))},t.deleteFileOrDir=function(e){return n(this,void 0,void 0,(function*(){try{yield o.remove(e)}catch(e){console.error(e)}}))}},142:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(22),o={error:function(e){console.log(n.red(e))},success:function(e){console.log(n.green(e))},primary:function(e){console.log(n.blue(e))},custom:function(){return n}};t.default=o},22:e=>{e.exports=require("chalk")},470:e=>{e.exports=require("fs-extra")},290:e=>{e.exports=require("inquirer")},336:e=>{e.exports=require("node-xlsx")},17:e=>{e.exports=require("path")}},t={};(0,function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}(519).default)()})();