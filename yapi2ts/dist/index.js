(()=>{"use strict";var e={245:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function c(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,c)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=r(133),i=r(290),a=(r(147),r(17)),c=r(37),u=r(139),s=r(602),l={integer:"number"},p=e=>{let t="{",r=Object.keys(e);for(const n of r){let r=e[n].type;if("object"===r)t+=`\n            ${n} : ${p(e[n].properties)};\n`;else if("array"===r){let r=e[n].items.type;t+="object"===r?`\n                ${n} : Array<${p(e[n].items.properties)}>;\n    `:`\n                ${n} : Array<${r}>;\n    `}else{let o=e[n].description;t+=`\n            ${n} : ${l[r]||r};  ${o?`// ${o}`:""}\n`}}return t+="}",t};!function(){n(this,void 0,void 0,(function*(){let e={token:""};try{let t=a.join(c.homedir(),"yapitoken.txt");try{e=JSON.parse(yield(0,o.readJSON)(t))}catch(r){u.default.error("\n不存在yapitoken，请输入");let n=[{type:"input",message:"请填写yapitoken：",name:"token",validate:function(e){return 0!=e.trim().length||(u.default.error("\n不允许为空"),!1)},default:""}],{token:a}=yield i.prompt(n);a=a.trim(),e.token=a,(0,o.writeJSON)(t,JSON.stringify(e))}let r=(yield i.prompt([{type:"input",message:"请填写接口文档的地址：",name:"url",validate:function(e){return 0!=e.trim().length||(u.default.error("\n不允许为空"),!1)},default:""}])).url;r=r.trim();let n={id:r.split("/").pop().split("_").pop(),token:e.token},l=yield(0,s.interfaceGet)(n),{errcode:f,errmsg:d,data:y}=l.data;if(0!==f)return u.default.error(d+",errcode:"+f),console.log(),u.default.error("请检查yapi token是否正确:"+e.token),console.log(),u.default.error("请检查url是否正确："+r),console.log(),u.default.primary("url举例: https://yapi.xxx.cn/project/1637/interface/api/26013"),void(40011===f&&(0,o.deleteFileOrDir)(t));let h={properties:{}};try{h=JSON.parse(y.res_body)}catch(e){u.default.error("接口信息不完整\n"),console.error(e),console.log(y)}let m=p(h.properties),v=(e=>e?e.charAt(0).toUpperCase()+e.slice(1):e)(y.path.split("/").pop());m=`interface ${v} `+m,m+=`\n// ${y.title} ${r}\nexport function ${y.path.split("/").slice(-2).join("_")}(params: any): Promise<${v}> {\n    return instance.request({\n        url: '${y.path}',\n        method: '${y.method}',\n        params\n    })\n}\n`,console.log(m)}catch(t){u.default.error("请检查yapi token是否正确:"+e.token),u.default.error("请检查url是否正确："),u.default.primary("url举例: https://yapi.xxx.cn/project/1637/interface/api/26013")}}))}()},602:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.interfaceGet=t.interfaceListCat=void 0;const n=r(139),o=r(167).default.create({baseURL:"https://yapi.inkept.cn/",timeout:5e3});o.interceptors.response.use((e=>e),(e=>(n.default.error("接口权限有问题！请检查当前token是否有访问该接口的权限！"),Promise.reject(e)))),t.interfaceListCat=function(e){return o.request({url:"/api/interface/list_cat",method:"GET",params:e})},t.interfaceGet=function(e){return o.request({url:"/api/interface/get",method:"GET",params:e})}},133:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function c(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,c)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteFileOrDir=t.writeJSON=t.readJSON=void 0;const o=r(470);t.readJSON=function(e){return n(this,void 0,void 0,(function*(){try{return yield o.readJson(e,{throws:!1})}catch(e){throw e}}))},t.writeJSON=function(e,t){return n(this,void 0,void 0,(function*(){try{yield o.outputFile(e,JSON.stringify(t,null,"\t"))}catch(e){console.error(e)}}))},t.deleteFileOrDir=function(e){return n(this,void 0,void 0,(function*(){try{yield o.remove(e)}catch(e){console.error(e)}}))}},139:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(22),o={error:function(e){console.log(n.red(e))},success:function(e){console.log(n.green(e))},primary:function(e){console.log(n.blue(e))},custom:function(){return n}};t.default=o},167:e=>{e.exports=require("axios")},22:e=>{e.exports=require("chalk")},470:e=>{e.exports=require("fs-extra")},290:e=>{e.exports=require("inquirer")},147:e=>{e.exports=require("fs")},37:e=>{e.exports=require("os")},17:e=>{e.exports=require("path")}},t={};!function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}(245)})();